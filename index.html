<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>Say it ain't so, Meow!</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="descripton" content="You can easily tweet 'Meow!'">
    <meta property="og:title" content="Say it ain't so, Meow!" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://arccosine.github.io/nyaan/" />
    <meta property="og:site_name" content="Say it ain't so, Meow!" />
    <meta property="og:description" content="You can easily tweet 'Meow!'" />
    <meta property="og:image" content="https://arccosine.github.io/nyaan/basecat.png" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Say it ain't so, Meow!">
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="152x152" href="apple-touch-icon.png">
    <link rel="manifest" href="manifest.json">
    <style>
body { text-align: center; background: #7E735F; padding: 0; margin: 0; } a.text { font-size: 5vh; text-decoration: none; color: rgba(255,255,255,.5); display: block; padding: 2.5vh 0; height: 5vh; line-height: 5vh; border-bottom: solid 1px rgba(255,255,255,.5); } a.active{ color: #999 !important; } header { padding: 2.5vh 0; border-bottom: solid 1px rgba(255,255,255,.5); } footer { color: rgba(255,255,255,.5); } footer a { color: rgba(255,255,255,.5); }
    </style>
    <script>
const keyEvents = (eve) => {
  if (eve.defaultPrevented) {
    return; // Do nothing if the event was already processed
  }
  const active = document.querySelector('.active');
  const keyName = eve.key;
  switch(event.key){
    case 'Enter':
      active.click();
      break;
    case 'ArrowDown':
    case 'j':
      if( active.nextSibling ){
        active.classList.remove('active');
        active.nextSibling.classList.add('active');
        window.scrollTo( 0, active.nextSibling.offsetTop );
      }
      break;
    case 'ArrowUp':
    case 'k':
      if( active.previousSibling ){
        active.classList.remove('active');
        active.previousSibling.classList.add('active');
        window.scrollTo( 0, active.previousSibling.offsetTop );
      }
      break;
    default:
      return;
  };
  eve.preventDefault();
};
const load = ()=>{
  const backColors=["FFB900","E74856","0078D7","0099BC","7A7574","767676","FF8C00","E81123","0063B1","2D7D9A","5D5A58","4C4A48","F7630C","EA005E","8E8CD8","00B7C3","68768A","69797E","CA5010","C30052","6B69D6","038387","515C6B","4A5459","DA3B01","E3008C","8764B8","00B294","567C73","647C64","EF6950","BF0077","744DA9","018574","486860","525E54","D13438","C239B3","B146C2","00CC6A","498205","847545","FF4343","9A0089","881798","10893E","107C10","7E735F"];
  document.body.style.backgroundColor = `#${backColors[Math.floor(Math.random()*backColors.length-1)]}`;
  const sayMeow = (text, index ) => {
    const section = document.querySelector('section');
    const link = section.appendChild(document.createElement('a'));
    const hashtag = 'nyaan';
    link.appendChild(document.createTextNode(text));
    link.setAttribute('href', `https://twitter.com/share?text=${encodeURIComponent(text)}&url=${encodeURIComponent('https://bit.ly/2Ja5WoG')}&hashtags=${encodeURIComponent(hashtag)}`);
    link.setAttribute('target', '_blank');
    link.classList.add('text');
    if( index === 0 ){
        link.classList.add('active');
    }
  };
  ['みゃー……','うにゃ……','にゃーん……','にゃーん！','にゃ～ん！','にゃ～ん?','にゃんにゃん！','うにゃー','みゃぉー','にゃー','にゃーぉ','ごろにゃー','うみゃう','みゃー','なーご','ふかーっ！'].sort(()=>{return Math.random()-.5}).forEach(sayMeow);

  const headerImg = document.querySelector('header img'); 
  headerImg.addEventListener('click', (eve)=>{
    eve.preventDefault();
    const links = document.querySelectorAll('a.text');
    location.href = links[Math.floor(Math.random()*links.length-1)].href;
  });

  window.addEventListener('keydown', keyEvents, false);
};
const nyaan = (res)=>{
  const pos = Math.floor(Math.random()*res.length);
  const catLink = res[pos];
  const image = new Image();
  image.src = catLink;
  image.addEventListener('load',()=>{
    const headerImg = document.querySelector('header img');
    headerImg.src = catLink 
  }, false );
};
window.addEventListener('load', function() {
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register("./serviceworker.js")
      .then(function(registration) {
        console.log("serviceWorker registed.");
      }).catch(function(error) {
        console.warn("serviceWorker error.", error);
      });
  }
});
document.addEventListener('DOMContentLoaded', load, false );
window.nyaan = nyaan;
    </script>
    <script src="https://script.google.com/macros/s/AKfycbzeDnzoGh0ht17HfPlrCRjoVouWxYvpYP3aPafox2FzAfnxnc79/exec?callback=nyaan" async></script>
  </head>
  <body>
    <header><img src="basecat.png"></header>
    <section></section>
    <footer>Icons made by <a href="http://www.freepik.com" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></footer>
  </body>
</html>
